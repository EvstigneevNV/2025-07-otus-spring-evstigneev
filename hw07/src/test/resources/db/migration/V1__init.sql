CREATE TABLE IF NOT EXISTS author
(
    id        BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    full_name VARCHAR(50) NOT NULL
);

CREATE TABLE IF NOT EXISTS genre
(
    id   BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(50) NOT NULL
);

CREATE TABLE IF NOT EXISTS book
(
    id        BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    title     VARCHAR(255) NOT NULL,
    author_id BIGINT NOT NULL,
    CONSTRAINT fk_book_author FOREIGN KEY (author_id) REFERENCES author (id)
);

CREATE TABLE IF NOT EXISTS books_genres
(
    book  BIGINT NOT NULL,
    genre BIGINT NOT NULL,
    CONSTRAINT fk_bxg_book FOREIGN KEY (book) REFERENCES book (id),
    CONSTRAINT fk_bxg_genre FOREIGN KEY (genre) REFERENCES genre (id),
    CONSTRAINT pk_bxg PRIMARY KEY (book, genre)
);

CREATE TABLE IF NOT EXISTS comment
(
    id      BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    text    VARCHAR(255) NOT NULL,
    book_id BIGINT NOT NULL,
    CONSTRAINT fk_book_comments FOREIGN KEY (book_id) REFERENCES book (id)
);

